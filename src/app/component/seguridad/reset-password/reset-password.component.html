<div class="reset-container">
  <div class="card p-4 shadow-lg reset-card">

    <!-- Logo -->
    <div class="text-center mb-4">
      <img src="/assets/images/inve.png" alt="Logo JKC Inventory" class="reset-logo">
    </div>

    <!-- Validación del token -->
    <ng-container *ngIf="tokenValido; else tokenInvalido">

      <h3 class="text-center mb-3 text-white">Restablecer Contraseña</h3>
      <p class="text-center small text-light">
        Ingresa tu nueva contraseña para continuar.
      </p>

      <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">

        <!-- Contraseña -->
        <div class="form-group text-white">
          <label for="contrasena">Nueva Contraseña</label>
          <input type="password" id="contrasena" class="form-control"
                 placeholder="********" formControlName="contrasena">
          <div class="form-text text-danger"
               *ngIf="f['contrasena'].errors?.['required'] && (f['contrasena'].touched || f['contrasena'].dirty)">
            La contraseña es obligatoria
          </div>
          <div class="form-text text-danger"
               *ngIf="f['contrasena'].errors?.['minlength']">
            La contraseña debe tener al menos 6 caracteres
          </div>
        </div>

        <!-- Confirmar Contraseña -->
        <div class="form-group mt-3 text-white">
          <label for="confirmarContrasena">Confirmar Contraseña</label>
          <input type="password" id="confirmarContrasena" class="form-control"
                 placeholder="********" formControlName="confirmarContrasena">
          <div class="form-text text-danger"
               *ngIf="resetPasswordForm.errors?.['mismatch'] && (f['confirmarContrasena'].touched || f['confirmarContrasena'].dirty)">
            Las contraseñas no coinciden
          </div>
        </div>

        <!-- Botón -->
        <button type="submit" class="btn btn-primary w-100 mt-4"
                [disabled]="resetPasswordForm.invalid">
          Cambiar Contraseña
        </button>
      </form>

    </ng-container>

    <!-- Token inválido -->
    <ng-template #tokenInvalido>
      <h4 class="text-center text-danger mb-3 fw-bold">Token inválido o expirado</h4>
      <p class="text-center small text-light">
        El enlace de recuperación ya no es válido. Solicita nuevamente la recuperación de tu contraseña.
      </p>
      
      <div class="text-center">
        <a [routerLink]="['/recuperacion-clave']" class="btn btn-outline-light">
          Recuperar de nuevo
        </a>
      </div>
    </ng-template>

    <!-- Volver -->
    <div class="text-center mt-3">
      <a [routerLink]="['/acceso']" class="text-white">Volver al login</a>
    </div>
  </div>
</div>
